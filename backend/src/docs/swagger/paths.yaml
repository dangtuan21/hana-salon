paths:
  /:
    get:
      tags: [API Info]
      summary: Server information
      description: Returns basic server information and API entry point
      responses:
        200:
          description: Server information
          content:
            application/json:
              schema:
                type: object
                properties:
                  success:
                    type: boolean
                  message:
                    type: string
                  version:
                    type: string
                  timestamp:
                    type: string
                    format: date-time
                  environment:
                    type: string
                  apiPrefix:
                    type: string
              example:
                success: true
                message: "Hana AI Backend Server"
                version: "1.0.0"
                timestamp: "2023-11-18T00:15:00.000Z"
                environment: "development"
                apiPrefix: "/api"

  /api:
    get:
      tags: [API Info]
      summary: API information
      description: Returns basic information about the API and available endpoints
      responses:
        200:
          description: API information
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          version:
                            type: string
                          endpoints:
                            type: object
                            properties:
                              health:
                                type: string
                              ready:
                                type: string
                              live:
                                type: string
                              documentation:
                                type: string
              example:
                success: true
                message: "Hana AI Backend API"
                data:
                  version: "1.0.0"
                  endpoints:
                    health: "/api/health"
                    ready: "/api/ready"
                    live: "/api/live"
                    documentation: "/api-docs"
                timestamp: "2023-11-18T00:15:00.000Z"

  /api/health:
    get:
      tags: [Health]
      summary: Comprehensive health check
      description: Returns detailed health information including uptime, version, and service status
      responses:
        200:
          description: Service is healthy
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/HealthCheckResponse'
              example:
                success: true
                message: "Service is healthy"
                data:
                  status: "healthy"
                  timestamp: "2023-11-18T00:15:00.000Z"
                  uptime: 3600
                  version: "1.0.0"
                  environment: "development"
                  services:
                    database: "disconnected"
                    aiService: "disconnected"
                timestamp: "2023-11-18T00:15:00.000Z"
        500:
          $ref: '#/components/responses/InternalServerError'

  /api/ready:
    get:
      tags: [Health]
      summary: Readiness probe
      description: Kubernetes readiness probe endpoint - checks if service is ready to accept traffic
      responses:
        200:
          description: Service is ready
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          ready:
                            type: boolean
              example:
                success: true
                message: "Service is ready"
                data:
                  ready: true
                timestamp: "2023-11-18T00:15:00.000Z"
        503:
          description: Service is not ready
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/ErrorResponse'

  /api/live:
    get:
      tags: [Health]
      summary: Liveness probe
      description: Kubernetes liveness probe endpoint - checks if service is alive
      responses:
        200:
          description: Service is alive
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          alive:
                            type: boolean
              example:
                success: true
                message: "Service is alive"
                data:
                  alive: true
                timestamp: "2023-11-18T00:15:00.000Z"

  /api/services:
    get:
      tags: [Services]
      summary: Get all services
      description: Retrieve all salon services with their details
      responses:
        200:
          description: Services retrieved successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          services:
                            type: array
                            items:
                              $ref: '#/components/schemas/Service'
                          count:
                            type: integer
              example:
                success: true
                message: "Services retrieved successfully"
                data:
                  services:
                    - _id: "691bf2c5779a3bff78c776e7"
                      name: "Classic Manicure"
                      category: "Basic Services"
                      duration_minutes: 45
                      price: 35
                      description: "Traditional nail care with cuticle treatment"
                      required_skill_level: "Junior"
                      popularity_score: 8
                      created_at: "2025-11-18T04:15:01.850Z"
                      updated_at: "2025-11-18T04:15:01.850Z"
                  count: 16
                timestamp: "2023-11-18T00:15:00.000Z"
        500:
          $ref: '#/components/responses/InternalServerError'

    post:
      tags: [Services]
      summary: Create a new service
      description: Create a new salon service
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ServiceInput'
            example:
              name: "Gel Manicure"
              category: "Advanced Services"
              duration_minutes: 60
              price: 55
              description: "Long-lasting gel polish with UV curing"
              required_skill_level: "Senior"
              popularity_score: 9
      responses:
        201:
          description: Service created successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/Service'
              example:
                success: true
                message: "Service created successfully"
                data:
                  _id: "691bf2c5779a3bff78c776ea"
                  name: "Gel Manicure"
                  category: "Advanced Services"
                  duration_minutes: 60
                  price: 55
                  description: "Long-lasting gel polish with UV curing"
                  required_skill_level: "Senior"
                  popularity_score: 9
                  created_at: "2025-11-18T04:15:01.962Z"
                  updated_at: "2025-11-18T04:15:01.962Z"
                timestamp: "2023-11-18T00:15:00.000Z"
        400:
          $ref: '#/components/responses/BadRequest'
        500:
          $ref: '#/components/responses/InternalServerError'

  /api/services/{id}:
    get:
      tags: [Services]
      summary: Get service by ID
      description: Retrieve a specific service by its ID
      parameters:
        - name: id
          in: path
          required: true
          description: Service ID
          schema:
            type: string
            example: "691bf2c5779a3bff78c776e7"
      responses:
        200:
          description: Service retrieved successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/Service'
              example:
                success: true
                message: "Service retrieved successfully"
                data:
                  _id: "691bf2c5779a3bff78c776e7"
                  name: "Classic Manicure"
                  category: "Basic Services"
                  duration_minutes: 45
                  price: 35
                  description: "Traditional nail care with cuticle treatment"
                  required_skill_level: "Junior"
                  popularity_score: 8
                  created_at: "2025-11-18T04:15:01.850Z"
                  updated_at: "2025-11-18T04:15:01.850Z"
                timestamp: "2023-11-18T00:15:00.000Z"
        404:
          $ref: '#/components/responses/NotFound'
        500:
          $ref: '#/components/responses/InternalServerError'

    put:
      tags: [Services]
      summary: Update service
      description: Update an existing service by its ID
      parameters:
        - name: id
          in: path
          required: true
          description: Service ID
          schema:
            type: string
            example: "691bf2c5779a3bff78c776e7"
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/ServiceUpdate'
            example:
              name: "Premium Classic Manicure"
              price: 40
              popularity_score: 9
      responses:
        200:
          description: Service updated successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/Service'
              example:
                success: true
                message: "Service updated successfully"
                data:
                  _id: "691bf2c5779a3bff78c776e7"
                  name: "Premium Classic Manicure"
                  category: "Basic Services"
                  duration_minutes: 45
                  price: 40
                  description: "Traditional nail care with cuticle treatment"
                  required_skill_level: "Junior"
                  popularity_score: 9
                  created_at: "2025-11-18T04:15:01.850Z"
                  updated_at: "2025-11-18T05:47:46.563Z"
                timestamp: "2023-11-18T00:15:00.000Z"
        400:
          $ref: '#/components/responses/BadRequest'
        404:
          $ref: '#/components/responses/NotFound'
        500:
          $ref: '#/components/responses/InternalServerError'

    delete:
      tags: [Services]
      summary: Delete service
      description: Delete a service by its ID
      parameters:
        - name: id
          in: path
          required: true
          description: Service ID
          schema:
            type: string
            example: "691bf2c5779a3bff78c776e7"
      responses:
        200:
          description: Service deleted successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          id:
                            type: string
                          name:
                            type: string
              example:
                success: true
                message: "Service deleted successfully"
                data:
                  id: "691bf2c5779a3bff78c776e7"
                  name: "Classic Manicure"
                timestamp: "2023-11-18T00:15:00.000Z"
        404:
          $ref: '#/components/responses/NotFound'
        500:
          $ref: '#/components/responses/InternalServerError'

  /api/customers:
    get:
      tags: [Customers]
      summary: Get all customers
      description: Retrieve all customers with pagination, search, and filtering
      parameters:
        - name: page
          in: query
          description: Page number for pagination
          schema:
            type: integer
            default: 1
        - name: limit
          in: query
          description: Number of items per page
          schema:
            type: integer
            default: 10
        - name: isActive
          in: query
          description: Filter by active status
          schema:
            type: boolean
        - name: search
          in: query
          description: Search by name or email
          schema:
            type: string
      responses:
        200:
          description: Customers retrieved successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          customers:
                            type: array
                            items:
                              $ref: '#/components/schemas/Customer'
                          pagination:
                            $ref: '#/components/schemas/Pagination'
        500:
          $ref: '#/components/responses/InternalServerError'

    post:
      tags: [Customers]
      summary: Create a new customer
      description: Create a new customer account
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/CustomerInput'
      responses:
        201:
          description: Customer created successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/Customer'
        400:
          $ref: '#/components/responses/BadRequest'
        500:
          $ref: '#/components/responses/InternalServerError'

  /api/technicians:
    get:
      tags: [Technicians]
      summary: Get all technicians
      description: Retrieve all technicians with pagination, search, and filtering
      parameters:
        - name: page
          in: query
          description: Page number for pagination
          schema:
            type: integer
            default: 1
        - name: limit
          in: query
          description: Number of items per page
          schema:
            type: integer
            default: 10
        - name: isActive
          in: query
          description: Filter by active status
          schema:
            type: boolean
        - name: skillLevel
          in: query
          description: Filter by skill level
          schema:
            type: string
            enum: [Junior, Senior, Expert, Master]
        - name: specialty
          in: query
          description: Filter by specialty
          schema:
            type: string
        - name: search
          in: query
          description: Search by name or employee ID
          schema:
            type: string
      responses:
        200:
          description: Technicians retrieved successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          technicians:
                            type: array
                            items:
                              $ref: '#/components/schemas/Technician'
                          pagination:
                            $ref: '#/components/schemas/Pagination'
        500:
          $ref: '#/components/responses/InternalServerError'

    post:
      tags: [Technicians]
      summary: Create a new technician
      description: Create a new technician profile
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/TechnicianInput'
      responses:
        201:
          description: Technician created successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/Technician'
        400:
          $ref: '#/components/responses/BadRequest'
        500:
          $ref: '#/components/responses/InternalServerError'

  /api/technicians/{id}:
    get:
      tags: [Technicians]
      summary: Get technician by ID
      description: Retrieve a specific technician by their ID
      parameters:
        - name: id
          in: path
          required: true
          description: Technician ID
          schema:
            type: string
      responses:
        200:
          description: Technician retrieved successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/Technician'
        404:
          $ref: '#/components/responses/NotFound'
        500:
          $ref: '#/components/responses/InternalServerError'

    put:
      tags: [Technicians]
      summary: Update technician
      description: Update an existing technician's information
      parameters:
        - name: id
          in: path
          required: true
          description: Technician ID
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/TechnicianUpdate'
      responses:
        200:
          description: Technician updated successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/Technician'
        400:
          $ref: '#/components/responses/BadRequest'
        404:
          $ref: '#/components/responses/NotFound'
        500:
          $ref: '#/components/responses/InternalServerError'

    delete:
      tags: [Technicians]
      summary: Deactivate technician
      description: Soft delete a technician by setting isActive to false
      parameters:
        - name: id
          in: path
          required: true
          description: Technician ID
          schema:
            type: string
      responses:
        200:
          description: Technician deactivated successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          id:
                            type: string
                          name:
                            type: string
                          employeeId:
                            type: string
                          email:
                            type: string
        404:
          $ref: '#/components/responses/NotFound'
        500:
          $ref: '#/components/responses/InternalServerError'

  /api/bookings:
    get:
      tags: [Bookings]
      summary: Get all bookings
      description: Retrieve all bookings with pagination and filtering
      parameters:
        - name: page
          in: query
          description: Page number for pagination
          schema:
            type: integer
            default: 1
        - name: limit
          in: query
          description: Number of items per page
          schema:
            type: integer
            default: 10
        - name: status
          in: query
          description: Filter by booking status
          schema:
            type: string
            enum: [initial, confirmed, in_progress, completed, cancelled]
        - name: customerId
          in: query
          description: Filter by customer ID
          schema:
            type: string
        - name: technicianId
          in: query
          description: Filter by technician ID
          schema:
            type: string
      responses:
        200:
          description: Bookings retrieved successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          bookings:
                            type: array
                            items:
                              $ref: '#/components/schemas/Booking'
                          pagination:
                            $ref: '#/components/schemas/Pagination'
        500:
          $ref: '#/components/responses/InternalServerError'

    post:
      tags: [Bookings]
      summary: Create a new booking
      description: Create a new booking with customer, technician, and services
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/BookingInput'
      responses:
        201:
          description: Booking created successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/Booking'
        400:
          $ref: '#/components/responses/BadRequest'
        500:
          $ref: '#/components/responses/InternalServerError'

  /api/bookings/{id}:
    get:
      tags: [Bookings]
      summary: Get booking by ID
      description: Retrieve a specific booking by its ID with populated data
      parameters:
        - name: id
          in: path
          required: true
          description: Booking ID
          schema:
            type: string
      responses:
        200:
          description: Booking retrieved successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/Booking'
        404:
          $ref: '#/components/responses/NotFound'
        500:
          $ref: '#/components/responses/InternalServerError'

    put:
      tags: [Bookings]
      summary: Update booking
      description: Update an existing booking's information
      parameters:
        - name: id
          in: path
          required: true
          description: Booking ID
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              $ref: '#/components/schemas/BookingUpdate'
      responses:
        200:
          description: Booking updated successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/Booking'
        400:
          $ref: '#/components/responses/BadRequest'
        404:
          $ref: '#/components/responses/NotFound'
        500:
          $ref: '#/components/responses/InternalServerError'

    delete:
      tags: [Bookings]
      summary: Delete booking
      description: Permanently delete a booking (hard delete)
      parameters:
        - name: id
          in: path
          required: true
          description: Booking ID
          schema:
            type: string
      responses:
        200:
          description: Booking deleted successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponse'
                  - type: object
                    properties:
                      data:
                        type: object
                        properties:
                          id:
                            type: string
                          message:
                            type: string
        404:
          $ref: '#/components/responses/NotFound'
        500:
          $ref: '#/components/responses/InternalServerError'

  /api/bookings/{id}/cancel:
    patch:
      tags: [Bookings]
      summary: Cancel booking
      description: Cancel a booking and update its status
      parameters:
        - name: id
          in: path
          required: true
          description: Booking ID
          schema:
            type: string
      requestBody:
        content:
          application/json:
            schema:
              type: object
              properties:
                reason:
                  type: string
                  description: Reason for cancellation
                  example: "Customer requested cancellation"
      responses:
        200:
          description: Booking cancelled successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/Booking'
        400:
          $ref: '#/components/responses/BadRequest'
        404:
          $ref: '#/components/responses/NotFound'
        500:
          $ref: '#/components/responses/InternalServerError'

  /api/bookings/{id}/complete:
    patch:
      tags: [Bookings]
      summary: Complete booking
      description: Mark a booking as completed
      parameters:
        - name: id
          in: path
          required: true
          description: Booking ID
          schema:
            type: string
      responses:
        200:
          description: Booking completed successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/Booking'
        400:
          $ref: '#/components/responses/BadRequest'
        404:
          $ref: '#/components/responses/NotFound'
        500:
          $ref: '#/components/responses/InternalServerError'

  /api/bookings/{id}/rate:
    patch:
      tags: [Bookings]
      summary: Rate booking
      description: Add customer rating and feedback to a completed booking
      parameters:
        - name: id
          in: path
          required: true
          description: Booking ID
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - rating
              properties:
                rating:
                  type: number
                  minimum: 1
                  maximum: 5
                  description: Customer rating (1-5 stars)
                  example: 4.5
                feedback:
                  type: string
                  description: Customer feedback
                  example: "Excellent service, very professional!"
      responses:
        200:
          description: Booking rated successfully
          content:
            application/json:
              schema:
                allOf:
                  - $ref: '#/components/schemas/ApiResponse'
                  - type: object
                    properties:
                      data:
                        $ref: '#/components/schemas/Booking'
        400:
          $ref: '#/components/responses/BadRequest'
        404:
          $ref: '#/components/responses/NotFound'
        500:
          $ref: '#/components/responses/InternalServerError'
